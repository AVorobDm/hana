#=============================================================================
# Setup unit tests
#=============================================================================
add_custom_target(tests
    COMMAND ${CMAKE_CTEST_COMMAND} --output-on-failure -R "test.+"
    COMMENT "Build and run all the unit tests.")

function(boost_hana_add_test name)
    string(REGEX REPLACE "[.]" "/" source ${name})
    add_executable(test.${name} EXCLUDE_FROM_ALL ${source}.cpp)
    add_test(NAME test.${name} COMMAND test.${name})
    add_dependencies(tests test.${name})
endfunction()


boost_hana_add_test(adapted.std_array.iterable)
boost_hana_add_test(adapted.std_integer_sequence.iterable)
boost_hana_add_test(adapted.std_tuple.functor)
boost_hana_add_test(adapted.std_tuple.iterable)

boost_hana_add_test(core.datatype)

boost_hana_add_test(detail.at_index)
boost_hana_add_test(detail.integer_sequence)
boost_hana_add_test(detail.left_folds)

boost_hana_add_test(foldable.all_of)
boost_hana_add_test(foldable.count)
boost_hana_add_test(foldable.foldr)
boost_hana_add_test(foldable.length)
boost_hana_add_test(foldable.maximum)
boost_hana_add_test(foldable.minimum)
boost_hana_add_test(foldable.product)
boost_hana_add_test(foldable.sum)
boost_hana_add_test(foldable.unpack)

boost_hana_add_test(functional.always)
boost_hana_add_test(functional.apply)
boost_hana_add_test(functional.arg)
boost_hana_add_test(functional.compose)
boost_hana_add_test(functional.curry)
boost_hana_add_test(functional.fbind)
boost_hana_add_test(functional.fix)
boost_hana_add_test(functional.flip)
boost_hana_add_test(functional.id)
boost_hana_add_test(functional.lockstep)
boost_hana_add_test(functional.on)
boost_hana_add_test(functional.partial)
boost_hana_add_test(functional.placeholder)

boost_hana_add_test(integral.api)
boost_hana_add_test(integral.bug_constexpr_init)
boost_hana_add_test(integral.bug_constexpr_value)
boost_hana_add_test(integral.bug_strip_cv_qualifiers)
boost_hana_add_test(integral.comparable)
boost_hana_add_test(integral.literals)
boost_hana_add_test(integral.operators)

boost_hana_add_test(iterable.at)
boost_hana_add_test(iterable.comparable)
boost_hana_add_test(iterable.drop)
boost_hana_add_test(iterable.drop_until)
boost_hana_add_test(iterable.drop_while)
boost_hana_add_test(iterable.find)
boost_hana_add_test(iterable.foldable)
boost_hana_add_test(iterable.last)

boost_hana_add_test(list.concat)
boost_hana_add_test(list.cons)
boost_hana_add_test(list.filter)
boost_hana_add_test(list.hetero.comparable)
boost_hana_add_test(list.hetero.foldable)
boost_hana_add_test(list.hetero.functor)
boost_hana_add_test(list.hetero.iterable)
boost_hana_add_test(list.init)
boost_hana_add_test(list.monad)
boost_hana_add_test(list.partition)
boost_hana_add_test(list.reverse)
boost_hana_add_test(list.snoc)
boost_hana_add_test(list.sort)
boost_hana_add_test(list.take)
boost_hana_add_test(list.take_until)
boost_hana_add_test(list.take_while)
boost_hana_add_test(list.type.bug_adl)
boost_hana_add_test(list.type.comparable)
boost_hana_add_test(list.type.foldable)
boost_hana_add_test(list.type.functor)
boost_hana_add_test(list.type.iterable)
boost_hana_add_test(list.zip)
boost_hana_add_test(list.zip_with)

boost_hana_add_test(logical.and)
boost_hana_add_test(logical.if)
boost_hana_add_test(logical.or)

boost_hana_add_test(maybe.api)
boost_hana_add_test(maybe.comparable)
boost_hana_add_test(maybe.functor)
boost_hana_add_test(maybe.monad)

boost_hana_add_test(range.comparable)
boost_hana_add_test(range.foldable)
boost_hana_add_test(range.iterable)

boost_hana_add_test(sandbox.array.api)
boost_hana_add_test(sandbox.assert)
boost_hana_add_test(sandbox.comparable_interop)
boost_hana_add_test(sandbox.dispatch)
boost_hana_add_test(sandbox.function)
boost_hana_add_test(sandbox.infix)
boost_hana_add_test(sandbox.llist)
boost_hana_add_test(sandbox.operator)
boost_hana_add_test(sandbox.string)
boost_hana_add_test(sandbox.worksheet)

boost_hana_add_test(type.bug_adl)
boost_hana_add_test(type.comparable)
boost_hana_add_test(type.decltype)
boost_hana_add_test(type.functor)
boost_hana_add_test(type.monad)
boost_hana_add_test(type.template)
boost_hana_add_test(type.trait)
boost_hana_add_test(type.type)

boost_hana_add_test(hana)
